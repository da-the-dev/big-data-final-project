0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> USE team26_projectdb;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> DROP TABLE IF EXISTS ${hivevar:RE SULT_TABLE};
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> CREATE EXTERNAL TABLE ${hivevar:R ESULT_TABLE} (
. . . . . . . . . . . . . . . . . . . . . . .>     distance_bucket STRING,
. . . . . . . . . . . . . . . . . . . . . . .>     avg_delay DOUBLE,
. . . . . . . . . . . . . . . . . . . . . . .>     count BIGINT
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY ','
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${hivevar:WAREHOUSE_PAT H}';
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> INSERT INTO ${hivevar:RESULT_TABL E}
. . . . . . . . . . . . . . . . . . . . . . .> SELECT
. . . . . . . . . . . . . . . . . . . . . . .>     CASE
. . . . . . . . . . . . . . . . . . . . . . .>         WHEN distance < 0.5 THEN  '<0.5 mi'
. . . . . . . . . . . . . . . . . . . . . . .>         WHEN distance >= 0.5 AND  distance < 1 THEN '0.5–1 mi'
. . . . . . . . . . . . . . . . . . . . . . .>         WHEN distance >= 1 AND di stance < 3 THEN '1–3 mi'
. . . . . . . . . . . . . . . . . . . . . . .>         ELSE '>3 mi'
. . . . . . . . . . . . . . . . . . . . . . .>     END AS distance_bucket,
. . . . . . . . . . . . . . . . . . . . . . .>     AVG(delay_from_typical_traffi c) AS avg_delay,
. . . . . . . . . . . . . . . . . . . . . . .>     COUNT(*) AS count
. . . . . . . . . . . . . . . . . . . . . . .> FROM traffic_partitioned
. . . . . . . . . . . . . . . . . . . . . . .> WHERE distance IS NOT NULL
. . . . . . . . . . . . . . . . . . . . . . .> GROUP BY CASE
. . . . . . . . . . . . . . . . . . . . . . .>     WHEN distance < 0.5 THEN '<0. 5 mi'
. . . . . . . . . . . . . . . . . . . . . . .>     WHEN distance >= 0.5 AND dist ance < 1 THEN '0.5–1 mi'
. . . . . . . . . . . . . . . . . . . . . . .>     WHEN distance >= 1 AND distan ce < 3 THEN '1–3 mi'
. . . . . . . . . . . . . . . . . . . . . . .>     ELSE '>3 mi'
. . . . . . . . . . . . . . . . . . . . . . .> END
. . . . . . . . . . . . . . . . . . . . . . .> ORDER BY avg_delay DESC;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> INSERT OVERWRITE DIRECTORY '${hiv evar:OUTPUT_PATH}'
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY ','
. . . . . . . . . . . . . . . . . . . . . . .> SELECT * FROM ${hivevar:RESULT_TA BLE};
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 